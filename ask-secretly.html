<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Secretly üí≠</title>
    
    <!-- OneSignal Push Notifications -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* Tema Deƒüi≈ükenleri */
        :root[data-theme="red"] {
            --primary: #dc2626;
            --primary-hover: #b91c1c;
            --primary-light: rgba(220, 38, 38, 0.1);
        }
        :root[data-theme="blue"] {
            --primary: #1d9bf0;
            --primary-hover: #1a8cd8;
            --primary-light: rgba(29, 155, 240, 0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
        }
        .container { max-width: 600px; margin: 0 auto; }
        
        /* Header */
        .header {
            background: #000;
            border-bottom: 1px solid #2f3336;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .logo { 
            font-size: 24px; 
            font-weight: bold; 
            color: var(--primary);
        }
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .theme-toggle {
            background: none;
            border: 1px solid #536471;
            color: #fff;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        .theme-toggle:hover { background: #1a1a1a; }
        .logout-btn {
            background: none;
            border: 1px solid #536471;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        .logout-btn:hover { background: #1a1a1a; }

        /* Profile Section */
        .profile-banner {
            height: 200px;
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
        }
        .profile-info {
            padding: 0 20px;
            margin-top: -70px;
        }
        .avatar {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            border: 4px solid #000;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .username {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .handle { color: #71767b; font-size: 15px; margin-bottom: 15px; }
        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            padding-bottom: 15px;
            border-bottom: 1px solid #2f3336;
        }
        .stat { font-size: 14px; }
        .stat strong { color: #fff; margin-right: 5px; }
        .stat span { color: #71767b; }

        /* Ask Box */
        .ask-box {
            background: #1a1a1a;
            margin: 20px;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #2f3336;
        }
        .ask-box h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary);
        }
        textarea {
            width: 100%;
            background: #000;
            border: 1px solid #2f3336;
            border-radius: 12px;
            padding: 15px;
            color: #fff;
            font-size: 15px;
            resize: none;
            min-height: 100px;
            font-family: inherit;
        }
        textarea:focus { outline: none; border-color: var(--primary); }
        .send-btn {
            width: 100%;
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 14px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 12px;
        }
        .send-btn:hover { background: var(--primary-hover); }
        .anonymous-note {
            text-align: center;
            color: #71767b;
            font-size: 13px;
            margin-top: 10px;
        }

        /* Questions Feed */
        .feed { padding: 0 20px 20px; }
        .question-item {
            background: #1a1a1a;
            border: 1px solid #2f3336;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
        }
        .question-text {
            font-size: 15px;
            line-height: 1.5;
            color: #e7e9ea;
            margin-bottom: 15px;
            background: #000;
            padding: 15px;
            border-radius: 12px;
            border-left: 3px solid var(--primary);
        }
        .answer-text {
            font-size: 15px;
            line-height: 1.5;
            color: #fff;
            margin-bottom: 15px;
        }
        .question-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid #2f3336;
        }
        .date { font-size: 13px; color: #71767b; }
        .share-twitter {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .share-twitter:hover { background: var(--primary-hover); }

        /* Auth Pages */
        .auth-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .auth-card {
            background: #1a1a1a;
            border: 1px solid #2f3336;
            border-radius: 16px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
        }
        .auth-card h1 {
            text-align: center;
            font-size: 32px;
            margin-bottom: 10px;
        }
        .theme-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }
        .theme-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid;
            background: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
        }
        .theme-btn.red {
            border-color: #dc2626;
            color: #dc2626;
        }
        .theme-btn.red.active {
            background: #dc2626;
            color: #fff;
        }
        .theme-btn.blue {
            border-color: #1d9bf0;
            color: #1d9bf0;
        }
        .theme-btn.blue.active {
            background: #1d9bf0;
            color: #fff;
        }
        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            font-size: 14px;
            margin-bottom: 8px;
            color: #e7e9ea;
        }
        .form-group input {
            width: 100%;
            background: #000;
            border: 1px solid #2f3336;
            border-radius: 8px;
            padding: 12px;
            color: #fff;
            font-size: 15px;
        }
        .form-group input:focus { outline: none; border-color: var(--primary); }
        .auth-btn {
            width: 100%;
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 14px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .auth-btn:hover { background: var(--primary-hover); }
        .auth-link {
            text-align: center;
            margin-top: 20px;
            color: #71767b;
            font-size: 14px;
        }
        .auth-link a {
            color: var(--primary);
            text-decoration: none;
        }
        .auth-link a:hover { text-decoration: underline; }

        /* Dashboard */
        .dashboard-header {
            padding: 20px;
            border-bottom: 1px solid #2f3336;
        }
        .profile-link-box {
            background: #1a1a1a;
            border: 1px solid #2f3336;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .profile-link-box label {
            font-size: 14px;
            color: #71767b;
            display: block;
            margin-bottom: 8px;
        }
        .link-input-group {
            display: flex;
            gap: 10px;
        }
        .link-input-group input {
            flex: 1;
            background: #000;
            border: 1px solid #2f3336;
            border-radius: 8px;
            padding: 10px;
            color: #fff;
            font-size: 14px;
        }
        .copy-btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #2f3336;
            margin-top: 20px;
        }
        .tab {
            flex: 1;
            background: none;
            border: none;
            color: #71767b;
            padding: 15px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            border-bottom: 2px solid transparent;
        }
        .tab.active {
            color: #fff;
            border-bottom-color: var(--primary);
        }
        .inbox-item {
            background: #1a1a1a;
            border: 1px solid #2f3336;
            border-radius: 16px;
            padding: 20px;
            margin: 15px 20px;
        }
        .answer-input {
            width: 100%;
            background: #000;
            border: 1px solid #2f3336;
            border-radius: 12px;
            padding: 12px;
            color: #fff;
            font-size: 14px;
            resize: none;
            min-height: 80px;
            margin-top: 12px;
        }
        .answer-btn {
            width: 100%;
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 12px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #71767b;
            font-size: 13px;
            cursor: pointer;
            margin-top: 10px;
        }
        .delete-btn:hover { color: #f4212e; }

        .hidden { display: none !important; }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary);
            color: #fff;
            padding: 15px 25px;
            border-radius: 12px;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div id="notification" class="notification"></div>

    <!-- Landing Page -->
    <div id="landingPage" class="auth-page">
        <div class="auth-card">
            <h1>üí≠ Ask Secretly</h1>
            <div class="theme-selector">
                <button class="theme-btn red active" onclick="setTheme('red')">üî¥ Kƒ±rmƒ±zƒ±</button>
                <button class="theme-btn blue" onclick="setTheme('blue')">üîµ Mavi</button>
            </div>
            <button class="auth-btn" onclick="showSignup()">Kayƒ±t Ol</button>
            <button class="auth-btn" onclick="showLogin()" style="background: #000; border: 1px solid var(--primary); margin-top: 15px;">Giri≈ü Yap</button>
        </div>
    </div>

    <!-- Signup Page -->
    <div id="signupPage" class="auth-page hidden">
        <div class="auth-card">
            <h1>Hesap Olu≈ütur</h1>
            <div class="form-group">
                <label>Kullanƒ±cƒ± Adƒ±</label>
                <input type="text" id="signupUsername" placeholder="kullaniciadi">
            </div>
            <div class="form-group">
                <label>≈ûifre</label>
                <input type="password" id="signupPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            <button class="auth-btn" onclick="handleSignup()">Hesap Olu≈ütur</button>
            <div class="auth-link">
                Hesabƒ±n var mƒ±? <a href="#" onclick="showLogin(); return false;">Giri≈ü Yap</a>
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="auth-page hidden">
        <div class="auth-card">
            <h1>Giri≈ü Yap</h1>
            <div class="form-group">
                <label>Kullanƒ±cƒ± Adƒ±</label>
                <input type="text" id="loginUsername" placeholder="kullaniciadi">
            </div>
            <div class="form-group">
                <label>≈ûifre</label>
                <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            <button class="auth-btn" onclick="handleLogin()">Giri≈ü Yap</button>
            <div class="auth-link">
                Hesabƒ±n yok mu? <a href="#" onclick="showSignup(); return false;">Kayƒ±t Ol</a>
            </div>
        </div>
    </div>

    <!-- Profile Page (Public) -->
    <div id="profilePage" class="hidden">
        <div class="container">
            <div class="profile-banner"></div>
            <div class="profile-info">
                <div class="avatar" id="profileAvatar"></div>
                <div class="username" id="profileUsername"></div>
                <div class="handle" id="profileHandle"></div>
                <div class="stats">
                    <div class="stat"><strong id="totalQuestions">0</strong> <span>Soru</span></div>
                    <div class="stat"><strong id="totalAnswered">0</strong> <span>Cevap</span></div>
                </div>
            </div>
            
            <div class="ask-box">
                <h3>Anonim soru sor</h3>
                <textarea id="questionInput" placeholder="Sorunuzu buraya yazƒ±n..."></textarea>
                <button class="send-btn" onclick="sendQuestion()">G√∂nder</button>
                <div class="anonymous-note">üîí Kimliƒüin gizli kalacak</div>
            </div>

            <div class="feed" id="answeredFeed"></div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardPage" class="hidden">
        <div class="header">
            <div class="logo">Ask Secretly</div>
            <div class="header-actions">
                <button class="theme-toggle" onclick="toggleTheme()">üé®</button>
                <button class="logout-btn" onclick="logout()">√áƒ±kƒ±≈ü</button>
            </div>
        </div>
        <div class="container">
            <div class="dashboard-header">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div class="avatar" id="dashAvatar" style="width: 60px; height: 60px; font-size: 24px; margin: 0;"></div>
                    <div>
                        <div class="username" id="dashUsername"></div>
                        <div class="handle" id="dashHandle"></div>
                    </div>
                </div>
                
                <div class="profile-link-box">
                    <label>Profil Linkin</label>
                    <div class="link-input-group">
                        <input type="text" id="profileLink" readonly>
                        <button class="copy-btn" onclick="copyLink()">Kopyala</button>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="showTab('inbox')">Gelen Kutusu (<span id="inboxCount">0</span>)</button>
                <button class="tab" onclick="showTab('answered')">Cevaplanmƒ±≈ü (<span id="answeredCount">0</span>)</button>
            </div>

            <div id="feedContainer"></div>
        </div>
    </div>

    <script>
        // OneSignal Initialization
        window.OneSignalDeferred = window.OneSignalDeferred || [];
        OneSignalDeferred.push(async function(OneSignal) {
            await OneSignal.init({
                appId: "54ca4ef2-dd2f-420e-a35c-f87ab31e979a",
                allowLocalhostAsSecureOrigin: true
            });
        });

        let users = JSON.parse(localStorage.getItem('askSecretly_users') || '{}');
        let questions = JSON.parse(localStorage.getItem('askSecretly_questions') || '{}');
        let currentUser = JSON.parse(localStorage.getItem('askSecretly_currentUser') || 'null');
        let currentTheme = localStorage.getItem('askSecretly_theme') || 'red';
        let currentTab = 'inbox';

        // Set initial theme
        document.documentElement.setAttribute('data-theme', currentTheme);

        function setTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('askSecretly_theme', theme);
            
            // Update theme buttons
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function toggleTheme() {
            const newTheme = currentTheme === 'red' ? 'blue' : 'red';
            setTheme(newTheme);
        }

        function saveData() {
            localStorage.setItem('askSecretly_users', JSON.stringify(users));
            localStorage.setItem('askSecretly_questions', JSON.stringify(questions));
            localStorage.setItem('askSecretly_currentUser', JSON.stringify(currentUser));
        }

        function showNotification(msg) {
            const notif = document.getElementById('notification');
            notif.textContent = msg;
            notif.style.display = 'block';
            setTimeout(() => notif.style.display = 'none', 3000);
        }

        function showPage(pageId) {
            ['landingPage', 'signupPage', 'loginPage', 'profilePage', 'dashboardPage'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');
        }

        function showLanding() { showPage('landingPage'); }
        function showSignup() { showPage('signupPage'); }
        function showLogin() { showPage('loginPage'); }

        async function handleSignup() {
            const username = document.getElementById('signupUsername').value.toLowerCase().trim();
            const password = document.getElementById('signupPassword').value;

            if (username.length < 3) {
                showNotification('Kullanƒ±cƒ± adƒ± en az 3 karakter olmalƒ±!');
                return;
            }
            if (users[username]) {
                showNotification('Bu kullanƒ±cƒ± adƒ± alƒ±nmƒ±≈ü!');
                return;
            }

            users[username] = { username, password, createdAt: Date.now() };
            currentUser = users[username];
            saveData();
            
            // OneSignal - Set External User ID
            if (window.OneSignal) {
                OneSignalDeferred.push(function(OneSignal) {
                    OneSignal.login(username);
                });
            }
            
            showNotification('Hesap olu≈üturuldu! üéâ');
            setTimeout(() => loadDashboard(), 500);
        }

        async function handleLogin() {
            const username = document.getElementById('loginUsername').value.toLowerCase().trim();
            const password = document.getElementById('loginPassword').value;

            if (!users[username] || users[username].password !== password) {
                showNotification('Kullanƒ±cƒ± adƒ± veya ≈üifre hatalƒ±!');
                return;
            }

            currentUser = users[username];
            saveData();
            
            // OneSignal - Set External User ID
            if (window.OneSignal) {
                OneSignalDeferred.push(function(OneSignal) {
                    OneSignal.login(username);
                });
            }
            
            showNotification('Ho≈ü geldin! üí≠');
            setTimeout(() => loadDashboard(), 500);
        }

        function logout() {
            // OneSignal - Remove External User ID
            if (window.OneSignal) {
                OneSignalDeferred.push(function(OneSignal) {
                    OneSignal.logout();
                });
            }
            
            currentUser = null;
            saveData();
            showNotification('√áƒ±kƒ±≈ü yapƒ±ldƒ±!');
            showLanding();
        }

        function loadProfile(username) {
            const user = users[username];
            if (!user) return;

            const avatar = document.getElementById('profileAvatar');
            avatar.textContent = username[0].toUpperCase();
            
            document.getElementById('profileUsername').textContent = username;
            document.getElementById('profileHandle').textContent = '@' + username;

            const userQ = questions[username] || [];
            const answered = userQ.filter(q => q.isAnswered);
            
            document.getElementById('totalQuestions').textContent = userQ.length;
            document.getElementById('totalAnswered').textContent = answered.length;

            const feed = document.getElementById('answeredFeed');
            feed.innerHTML = '';
            
            answered.reverse().forEach(q => {
                feed.innerHTML += `
                    <div class="question-item">
                        <div class="question-text">${q.question}</div>
                        <div class="answer-text">${q.answer}</div>
                        <div class="question-footer">
                            <div class="date">${new Date(q.answeredAt).toLocaleDateString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });

            showPage('profilePage');
        }

        async function sendQuestion() {
            const text = document.getElementById('questionInput').value.trim();
            if (!text) {
                showNotification('Soru yazmalƒ±sƒ±n!');
                return;
            }

            const urlParams = new URLSearchParams(window.location.search);
            const username = urlParams.get('u');

            const newQ = {
                id: Date.now().toString(),
                question: text,
                answer: null,
                isAnswered: false,
                createdAt: Date.now()
            };

            if (!questions[username]) questions[username] = [];
            questions[username].push(newQ);
            saveData();

            // Send Push Notification to User
            if (window.OneSignal) {
                try {
                    // OneSignal API call to send notification
                    const response = await fetch('https://onesignal.com/api/v1/notifications', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            app_id: '54ca4ef2-dd2f-420e-a35c-f87ab31e979a',
                            include_external_user_ids: [username],
                            headings: { en: 'Yeni Soru! üí≠' },
                            contents: { en: text.substring(0, 50) + '...' },
                            url: `${window.location.origin}${window.location.pathname}?u=${username}`
                        })
                    });
                } catch (error) {
                    console.log('Push notification error:', error);
                }
            }

            document.getElementById('questionInput').value = '';
            showNotification('Sorun g√∂nderildi! ‚úÖ');
        }

        function loadDashboard() {
            if (!currentUser) {
                showLanding();
                return;
            }

            const avatar = document.getElementById('dashAvatar');
            avatar.textContent = currentUser.username[0].toUpperCase();
            
            document.getElementById('dashUsername').textContent = currentUser.username;
            document.getElementById('dashHandle').textContent = '@' + currentUser.username;
            document.getElementById('profileLink').value = `${window.location.origin}${window.location.pathname}?u=${currentUser.username}`;

            showTab('inbox');
            showPage('dashboardPage');
        }

        function showTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            const userQ = questions[currentUser.username] || [];
            const inbox = userQ.filter(q => !q.isAnswered);
            const answered = userQ.filter(q => q.isAnswered);

            document.getElementById('inboxCount').textContent = inbox.length;
            document.getElementById('answeredCount').textContent = answered.length;

            const container = document.getElementById('feedContainer');
            const list = tab === 'inbox' ? inbox : answered;

            if (list.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #71767b;">Hen√ºz soru yok</div>';
                return;
            }

            container.innerHTML = '';
            list.reverse().forEach(q => {
                const div = document.createElement('div');
                div.className = 'inbox-item';
                div.innerHTML = `
                    <div class="question-text">${q.question}</div>
                    ${q.isAnswered ? `
                        <div class="answer-text">${q.answer}</div>
                        <div class="question-footer">
                            <div class="date">${new Date(q.answeredAt).toLocaleDateString('tr-TR')}</div>
                            <button class="share-twitter" onclick="shareToTwitter('${q.id}')">
                                üê¶ Twitter'da Payla≈ü
                            </button>
                        </div>
                    ` : `
                        <textarea class="answer-input" id="answer-${q.id}" placeholder="Cevabƒ±nƒ± yaz..."></textarea>
                        <button class="answer-btn" onclick="answerQuestion('${q.id}')">Cevapla</button>
                        <button class="delete-btn" onclick="deleteQuestion('${q.id}')">Sil</button>
                    `}
                `;
                container.appendChild(div);
            });
        }

        function answerQuestion(id) {
            const answer = document.getElementById('answer-' + id).value.trim();
            if (!answer) {
                showNotification('Cevap yazmalƒ±sƒ±n!');
                return;
            }

            const userQ = questions[currentUser.username];
            const q = userQ.find(q => q.id === id);
            q.answer = answer;
            q.isAnswered = true;
            q.answeredAt = Date.now();
            saveData();

            showNotification('Cevap kaydedildi! üí¨');
            loadDashboard();
        }

        function deleteQuestion(id) {
            questions[currentUser.username] = questions[currentUser.username].filter(q => q.id !== id);
            saveData();
            showNotification('Soru silindi!');
            loadDashboard();
        }

        function copyLink() {
            const link = document.getElementById('profileLink');
            link.select();
            document.execCommand('copy');
            showNotification('Link kopyalandƒ±! üìã');
        }

        function shareToTwitter(questionId) {
            const userQ = questions[currentUser.username];
            const q = userQ.find(qu => qu.id === questionId);
            if (!q) return;

            const tweetText = `${q.question}\n\n${q.answer}\n\nBana da anonim soru sor üëá\n${window.location.origin}${window.location.pathname}?u=${currentUser.username}`;
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
            window.open(twitterUrl, '_blank');
        }

        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const username = urlParams.get('u');
            
            if (username && users[username]) {
                loadProfile(username);
            } else if (currentUser) {
                loadDashboard();
            } else {
                showLanding();
            }
        };
    </script>
</body>
</html>